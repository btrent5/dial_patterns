# Dial Pattern Generator

Screenshots have been omitted, and may be replaced at some point

## Prerequisites

* User Import sheet (for the relevant building)
* python (3.7 recommended)
* lxml (python library)
* Excel (for wrangling data)
* Admin Credentials (to Avaya System Manager)

## Preparing Data

1. Create a copy of `BLDG_dp.xlsx` named appropriately and in Box.

2. Copy columns `A-F` from the user import spreadsheet. Ensure that `First Name`, `Last Name`, and `Line1 DN` are in columns `A`, `B`, and `F` respectively.
3. Paste into the `users` sheet of the newly copied and renamed `BLDG_dp.xlsx` file.
4. Use the fill features to make sure that every row is full. Double check the below points of possible failure.
    * Make sure to use `Copy Cells` instead of the default `Fill Series` on the columns `H` and `I`.
    * Make sure that names are being properly filled into column `A`
    * Make sure that the extensions are being filled into column `C`
5. Export the `pattern` sheet as a `.csv` file. \
    File > Export > Change File Type > CSV > Save As
6. Inspect the `.csv` file to ensure that there isn't any extra data (Excel does this sometimes). If this extra data exists, remove it. An example of what to delete is shown in red. To correct the shown example, simply delete lines 11-17.

## Running Script

All below commands expect that you have already navigated to the directory where the `.csv` file is and want to generate the `.xml` file in the same directory. Change those fields in the commands if you want to use different directories for source and destination.

### Windows

CMD:

    python routing_rules.py BLDG_dp.csv -f BLDG_dp.xml

PowerShell:

    .\routing_rules.py .\BLDG_dp.csv -f .\BLDG_dp.xml

### Mac/Linux

    python3 routing_rules.py BLDG_dp.csv -f BLDG_dp.xml

## Importing Patterns

1. Log into the System Manager with administrator credentials
2. Select the `Routing` element
3. Select the `Dial Patterns` menu on the left side of the page
4. Select `Import` from the `More Actions` dropdown
5. Browse for the `.xml` generated by the script and import
6. Return to the `Import` screen from the `Dial Patterns` menu and confirm that `Import Job Status` has the relevant job and that it completed with 0 `Failed Entries`